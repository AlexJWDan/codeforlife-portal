{% extends "portal/teach/base.html" %}

{% block nav_teacher_account %}<b><a href="{% url 'portal.views.teacher_edit_account' %}">Account</a></b>{% endblock nav_teacher_account %}

{% block content %}
<div class='span_centered_half'>
    <div class='login-card'>
        <h1>Enable Two-Factor Authentication</h1><br/>

        {% if wizard.steps.current == 'welcome' %}
            <p>You are about to take your account security to the
                    next level. Follow the steps in this wizard to enable two-factor
                    authentication.</p>

            <form action="" method="post">
                {% csrf_token %}
                {% include "two_factor/_wizard_forms.html" %}
                {% include "two_factor/_wizard_actions.html" %}
            </form>

        {% elif wizard.steps.current == 'method' %}
            <p>Please select which authentication method you would like to use.</p>

            <form action="" method="post">
                {% csrf_token %}
                {{ wizard.management_form }}

                {{ wizard.form.method.errors }}
                <div class='section group'>
                    <div class='col' style='width: 15%; height: 44px; line-height: 44px'>
                        <b>Method:</b>
                    </div>
                    <div class='col' style='width: 25%'>
                        <input id='id_method-method_0' name='method-method' type='radio' value='generator' style='margin-top: 14px'>
                        <label for='id_method-method_0' style='height: 30px; line-height: 30px'>Token</label>
                    </div>
                    <div class='col' style='width: 25%'>
                        <input id='id_method-method_1' name='method-method' type='radio' value='call' style='margin-top: 14px'>
                        <label for='id_method-method_1' style='height: 30px; line-height: 30px'>Phone call</label>
                    </div>
                    <div class='col' style='width: 25%'>
                        <input id='id_method-method_2' name='method-method' type='radio' value='sms' style='margin-top: 14px'>
                        <label for='id_method-method_2' style='height: 30px; line-height: 30px'>Text message</label>
                    </div>
                </div>

                {% include "two_factor/_wizard_actions.html" %}
            </form>

        {% elif wizard.steps.current == 'generator' %}
            <p>To start using a token generator, please use your
                    smartphone to scan the QR code below. For example, use Google
                    Authenticator. Then, enter the token generated by the app.
                    </p>

            <img src="{{ QR_URL }}" alt="QR Code" />

            <form action="" method="post">
                {% csrf_token %}
                {% include "two_factor/_wizard_forms.html" %}
                {% include "two_factor/_wizard_actions.html" %}
            </form>

        {% elif wizard.steps.current == 'sms' %}
            <p>Please enter the phone number you wish to receive the
                text messages on. This number will be validated in the next step.
                </p>

            <form action="" method="post">
                {% csrf_token %}

                {{ wizard.management_form }}

                {{ wizard.form.number.errors }}
                <div class='section group'>
                    <div class='col' style='width: 15%; height: 44px; line-height: 44px'>
                        <b>Number:</b>
                    </div>
                    <div class='col' style='width: 83%'>
                        <input id='id_sms-number' name='sms-number' maxlength='16' type='text'>
                    </div>
                </div>

                {% include "two_factor/_wizard_actions.html" %}
            </form>

        {% elif wizard.steps.current == 'call' %}
            <p>Please enter the phone number you wish to be called on.
                This number will be validated in the next step. </p>

            <form action="" method="post">
                {% csrf_token %}

                {{ wizard.management_form }}

                {{ wizard.form.number.errors }}
                <div class='section group'>
                    <div class='col' style='width: 15%; height: 44px; line-height: 44px'>
                        <b>Number:</b>
                    </div>
                    <div class='col' style='width: 83%'>
                        <input id='id_call-number' name='call-number' maxlength='16' type='text'>
                    </div>
                </div>

                {% include "two_factor/_wizard_actions.html" %}
            </form>

        {% elif wizard.steps.current == 'validation' %}
            {% if device.method == 'call' %}
                <p>We are calling your phone right now, please enter the
                    digits you hear.</p>
            {% elif device.method == 'sms' %}
                <p>We sent you a text message, please enter the tokens we
                    sent.</p>
            {% endif %}

            <form action="" method="post">
                {% csrf_token %}
                {% include "two_factor/_wizard_forms.html" %}
                {% include "two_factor/_wizard_actions.html" %}
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}
