{% extends 'portal/teach/base.html' %}
{% load static %}

{% block title %}Code For Life - Portal{% endblock %}

{% block content %}

<header>
    <span class='left'>
        <h1>[ code ] for { life }</h1>
    </span>
    <span class='right'>
        Logged in as {{ user.first_name }} {{ user.last_name }}
        <a class='portal_button logout' href="{% url 'portal.views.logout_view' %}">Logout</a>
    </span>
</header>

<div class='row'>
    {% if teacher.pending_join_request %}

        <div class='small-6 small-centered columns'>

            <p>You have a pending join request to '{{ teacher.pending_join_request.name }}'.</p>
            <p>You may only have one at a time, if you wish to join another you must revoke your pending request first.</p>

            <form method='post'>

                {% csrf_token %}

                <div class='row'>
                    <div class='small-12 columns'>
                        <input type='submit' name='revoke_join_request' value="Revoke request to '{{ teacher.pending_join_request.name }}'"/>
                    </div>
                </div>

            </form>
        </div>

    {% else %}

        <div class='small-6 columns'>
            <div class='panel radius'>
                <h3>Create a new organisation</h3>

                <p>You will be set up as the administrator of this new organisation and will be responsible for approving other teachers to join the organisation.</p>

                <form method='post'>

                    {% csrf_token %}

                    {{ create_form.non_field_errors }}

                    <div class='row'>
                        <div class='small-12 columns'>
                            {{ create_form.school.errors }}
                            {{ create_form.school }}
                        </div>
                    </div>

                    <div class='row'>
                        <div class='small-12 columns'>
                            {{ create_form.current_password.errors }}
                            {{ create_form.current_password }}
                        </div>
                    </div>

                    <div class='row'>
                        <div class='small-9 columns'></div>

                        <div class='small-3 columns'>
                            <input type='submit' name='create_organisation' value='Create'/>
                        </div>
                    </div>

                </form>
            </div>
        </div>

        <div class='small-6 columns'>
            <div class='panel radius'>
                <h3>Join an organisation</h3>

                <p>A request will be sent to the administrator of the organisation who will either accept or deny your request.</p>

                <form method='post'>

                    {% csrf_token %}

                    {{ join_form.non_field_errors }}

                    <div class='row'>
                        <div class='small-12 columns'>
                            {{ join_form.school.errors }}
                            {{ join_form.school }}
                        </div>
                    </div>

                    <div class='row'>
                        <div class='small-9 columns'></div>

                        <div class='small-3 columns'>
                            <input type='submit' name='join_organisation' value='Join'/>
                        </div>
                    </div>

                </form>
            </div>
        </div>

    {% endif %}
</div>

<footer>
    <small>Ocado Technology &copy; 2014</small>
</footer>

{% endblock %}
