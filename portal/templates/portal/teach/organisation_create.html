{% extends 'portal/teach/base.html' %}
{% load static %}

{% block scripts %}
<script type="text/javascript" src="{% static 'portal/js/fuzzySchoolLookup.js' %}"></script>
<script>
var FUZZY_NAME_FIELD_ID = '{{ join_form.fuzzy_name.auto_id }}';
var CHOSEN_ORG_FIELD_ID = '{{ join_form.chosen_org.auto_id }}';
var FUZZY_ORG_LOOKUP_URL = "{% url 'portal.views.organisation_fuzzy_lookup' %}";
</script>
{% endblock scripts %}

{% block nav_teacher_school %}<b><a href="{% url 'portal.views.organisation_manage' %}">School/Club</a></b>{% endblock nav_teacher_school %}

{% block content %}

<div class='section group'>
    {% if teacher.pending_join_request %}
    <div class='span_centered_half'>
        <div class='login-card'>

            <h3>Request to join a school or club</h3><br>

            <p>You have a pending join request to '{{ teacher.pending_join_request.name }}'.</p>
            <p>You may only have one at a time, if you wish to join another you must revoke your pending request first.</p>

            <form method='post'>

                {% csrf_token %}

                <div class='section group'>
                    <div class='span_centered_two_thirds'>
                        <input class='btn wide' type='submit' name='revoke_join_request' value="Revoke request to '{{ teacher.pending_join_request.name }}'"/>
                    </div>
                </div>

            </form>
        </div>
    </div>
    {% else %}

        <div class='col span_1_of_2'>
            <div class='login-card'>
                <h3>Create a new school or club</h3><br>

                <p>You will be set up as the administrator of this new school or club and will be responsible for approving other teachers to join it.</p>

                <form method='post'>

                    {% csrf_token %}

                    {{ create_form.non_field_errors }}

                    {% for field in create_form %}
                        {{ field.errors }}
                        <label class="ieLabels">{{ field.html_name }}</label>
                        {{ field }}
                    {% endfor %}

                    <div class='section group'>
                        <div class='col span_2_of_3'></div>

                        <div class='col span_1_of_3'>
                            <input type='submit' class='btn' name='create_organisation' value='Create'/>
                        </div>
                    </div>

                </form>
            </div>
        </div>

        <div class='col span_1_of_2'>
            <div class='login-card'>
                <h3>Join a school or club</h3><br>

                <p>A request will be sent to the administrator of the school or club who will either accept or deny your request.</p>

                <form method='post'>

                    {% csrf_token %}

                    {{ join_form.non_field_errors }}

                    {% for field in join_form %}
                        {{ field.errors }}
                        <label class="ieLabels">{{ field.html_name }}</label>
                        {{ field }}
                    {% endfor %}

                    <div class='section group'>
                        <div class='col span_2_of_3'></div>

                        <div class='col span_1_of_3'>
                            <input type='submit' class='btn' name='join_organisation' value='Join'/>
                        </div>
                    </div>

                </form>
            </div>
        </div>

    {% endif %}
</div>

{% endblock %}
