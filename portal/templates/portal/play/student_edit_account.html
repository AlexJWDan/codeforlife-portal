{% extends 'portal/play/base.html' %}
{% load static %}

{% block scripts %}
{{ block.super }}
<script type="text/javascript" src="{% static 'portal/js/passwordStrength.js' %}"></script>
<script>
var PASSWORD_FIELD_ID = '{{ form.password.auto_id }}';
var PASSWORD_TYPE = 'STUDENT';
</script>
{% endblock scripts %}

{% block content %}

<div class='section group'>

    <div class='span_centered_half'>

        <div class='login-card'>
            <h3>{% if user.userprofile.student.class_field %}My Password{% else %}My Account{% endif %}</h3><br>

            {% if user.userprofile.student.class_field %}
                <p>You may edit your password below. It must be long enough and hard enough to stop your friends guessing it and stealing all of your hard work!</p>
                <p>Your password is case insensitive, so it doesn't matter if you accidentally type a capital letter when you shouldn't.</p>
                <p>If you have any problems, ask a teacher to help you.</p>
            {% else %}
                <p>You may edit your account details below, including your name, password, and registered email address (if you change this, you will have to verify the email belongs to you or your parent or guardian by following the instructions on an email).</p>
                <p>Your password must be long enough and hard enough to stop your friends guessing it and stealing all of your hard work! It is also case insensitive, so it doesn't matter if you accidentally type a capital letter when you shouldn't.</p>
            {% endif %}

            <form method='post'>

                {% csrf_token %}

                {{ form.non_field_errors }}

                {% if not user.userprofile.student.class_field %}

                    {{ form.name.errors }}
                    <label class="ieLabels">{{ form.name.html_name }}</label>
                    {{ form.name }}

                    {{ form.email.errors }}
                    <label class="ieLabels">{{ form.email.html_name }}</label>
                    {{ form.email }}

                {% endif %}

                <div class='section group'>
                    <div class='col span_2_of_3 password-strength-bar-container'>
                        <div class='password-strength-bar'></div>
                    </div>
                    <div class='col span_1_of_3 password-strength-text'></div>
                </div>

                {{ form.password.errors }}
                <label class="ieLabels">{{ form.password.html_name }}</label>
                {{ form.password }}

                {{ form.confirm_password.errors }}
                <label class="ieLabels">{{ form.confirm_password.html_name }}</label>
                {{ form.confirm_password }}

                {{ form.current_password.errors }}
                <label class="ieLabels">{{ form.current_password.html_name }}</label>
                {{ form.current_password }}

                <div class='section group'>
                    <div class='col span_1_of_2'>
                        <a class='btn btn-default wide' href="{% url 'portal.views.student_details' %}">Cancel</a>
                    </div>
                    <div class='col span_1_of_2'>
                        <input type='submit' class='btn btn-primary wide' value='Update'/>
                    </div>
                </div>

            </form>
        </div>

    </div>
</div>

{% endblock %}
